openapi: 3.0.0

info:
  title: traQ API
  version: 0.0.1

servers:
  - url: /api/1.0

paths:
  /login:
    post:
      tags:
        - authentication
      description: ログインを行います。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - pass
              properties:
                name:
                  type: string
                pass:
                  type: string
      responses:
        "204":
          description: 正常にログインできました。

  /logout:
    post:
      tags:
        - authentication
      description: ログアウトを行います。
      responses:
        "204":
          description: |+
            正常にログアウトできました。

  /oauth2/authorize:
    get:
      tags:
        - authorization
      description: OAuth2 認可エンドポイント
      parameters:
        - name: response_type
          in: query
          schema:
            type: string
        - name: client_id
          in: query
          schema:
            type: string
        - name: redirect_uri
          in: query
          schema:
            type: string
        - name: scope
          in: query
          schema:
            type: string
        - name: state
          in: query
          schema:
            type: string
        - name: code_challenge
          in: query
          schema:
            type: string
        - name: code_challenge_method
          in: query
          schema:
            type: string
        - name: nonce
          in: query
          schema:
            type: string
        - name: prompt
          in: query
          schema:
            type: string

      responses:
        "302":
          description: 結果に応じてリダイレクトします。
        "400":
          description: リクエストが不正です。
        "403":
          description: リクエストが許可されていません。
    post:
      tags:
        - authorization
      description: OAuth2 認可エンドポイント
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                response_type:
                  type: string
                client_id:
                  type: string
                redirect_uri:
                  type: string
                scope:
                  type: string
                state:
                  type: string
                code_challenge:
                  type: string
                code_challenge_method:
                  type: string
                nonce:
                  type: string
                prompt:
                  type: string
      responses:
        "302":
          description: 結果に応じてリダイレクトします。
        "400":
          description: リクエストが不正です。
        "403":
          description: リクエストが許可されていません。

  /oauth2/authorize/decide:
    post:
      tags:
        - authorization
      description: OAuth2 認可承諾
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              required:
                - submit
              properties:
                submit:
                  type: string
                  description: 承諾する場合は"approve"
      responses:
        "302":
          description: RedirectURIに結果をリダイレクトします。
        "400":
          description: リクエストが不正です。
        "403":
          description: リクエストが許可されていません。

  /oauth2/token:
    post:
      tags:
        - authorization
      description: OAuth2 トークンエンドポイント
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              required:
                - grant_type
              properties:
                grant_type:
                  type: string
                code:
                  type: string
                redirect_uri:
                  type: string
                client_id:
                  type: string
                code_verifier:
                  type: string
                username:
                  type: string
                password:
                  type: string
                scope:
                  type: string
                refresh_token:
                  type: string
                client_secret:
                  type: string
      responses:
        "200":
          description: トークンが正常に発行されました。
          content:
            application/json:
              schema:
                type: object
                required:
                  - access_token
                  - token_type
                properties:
                  access_token:
                    type: string
                  token_type:
                    type: string
                  expires_in:
                    type: integer
                  refresh_token:
                    type: string
                  scope:
                    type: string
                  id_token:
                    type: string
        "400":
          description: トークン発行に失敗しました。
        "403":
          description: トークン発行に失敗しました。

  /channels:
    post:
      tags:
        - channel
      description: チャンネルを作成します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - type
              properties:
                type:
                  type: string
                  description: private or public
                member:
                  type: array
                  items:
                    type: string
                    format: uuid
                    description: |+
                      チャンネルに参加させるuserのuserId
                      publicの場合は初期状態の通知ONのユーザーとなります
                name:
                  type: string
                  description: チャンネル名 privateの場合は無視されます
                  example: random
                parent:
                  type: string
                  format: uuid
                  description: 親のチャンネルID privateの場合は無視されます
                  example: xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
      responses:
        "201":
          description: |+
            正常にチャンネルが作成できました。
            作成されたチャンネルを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Channel"
        "400":
          description: |+
            正常にチャンネルが作成できませんでした。
            親チャンネルが存在しない又は指定されたタイプに対して適切なプロパティが存在しません。
    get:
      tags:
        - channel
      description: |+
        (すべての)チャンネルのリストを取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            チャンネルの配列を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelList"

  /channels/{channelID}:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    get:
      tags:
        - channel
      description: チャンネルの情報を返します。
      responses:
        "200":
          description: |+
            正常に取得ができました。
            チャンネルを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Channel"
        "404":
          description: |+
            取得に失敗しました。
            指定したチャンネルは存在しません。
    patch:
      tags:
        - channel
      description: チャンネルの情報を変更します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: チャンネル名
                  example: gps
                parent:
                  type: string
                  format: uuid
                  description: 変更後の親のID。
                  example: xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
                visibility:
                  type: boolean
                  description: 変更後のvisibility
                  example: true
                force:
                  type: boolean
                  description: 強制通知かどうか
      responses:
        "204":
          description: 正常に変更ができました。
        "400":
          description: 失敗しました。リクエスト内容が不正です。
        "403":
          description: 失敗しました。権限がありません。
        "404":
          description: |+
            変更に失敗しました。
            指定したチャンネルは存在しません。
    delete:
      tags:
        - channel
      description: チャンネルを削除します。
      responses:
        "204":
          description: 削除に成功しました。
        "404":
          description: |+
            削除に失敗しました。
            指定したチャンネルは既に存在しません。

  /channels/{channelID}/topic:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    get:
      tags:
        - topic
      description: チャンネルの説明を取得します。
      responses:
        "200":
          description: |+
            正常に取得ができました。
            チャンネルトピックを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelTopic"
        "404":
          description: |+
            取得に失敗しました。
            指定したチャンネルは存在しません。
    put:
      tags:
        - topic
      description: チャンネルの説明を変更します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  description: チャンネルの説明
                  example: なんでも良いチャンネルです!!
      responses:
        "200":
          description: |+
            正常に更新できました。
            更新後のチャンネルトピックを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelTopic"
        "404":
          description: |+
            更新に失敗しました。
            指定したチャンネルは存在しません。

  /channels/{channelID}/messages:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    get:
      tags:
        - message
      description: チャンネルに存在するメッセージを取得します。
      parameters:
        - in: query
          name: limit
          schema:
            type: integer
          description: 取得する件数 1-200
          example: 50
        - in: query
          name: offset
          schema:
            type: integer
          description: 取得するメッセージのオフセット
          example: 150
      responses:
        "200":
          description: |+
            正常に取得ができました。
            メッセージの配列を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageList"
        "400":
          description: |+
            変更に失敗しました
            不正なリクエストです
        "404":
          description: |+
            取得に失敗しました。
            指定したチャンネルは存在しません。
    post:
      tags:
        - message
      description: チャンネルにメッセージを投稿します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  description: Markdown形式のメッセージ本文
                  example: Raskって誰？
      responses:
        "201":
          description: |+
            投稿に成功しました。
            投稿されたメッセージが返されます。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: |+
            投稿に失敗しました。
            指定したチャンネルは存在しません。

  /channels/{channelID}/pin:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    get:
      tags:
        - pin
      description: チャンネルのピン留め一覧を取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PinList"
    post:
      tags:
        - pin
      description: チャンネルにメッセージをピン留めします。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - messageId
              properties:
                messageId:
                  type: string
                  format: uuid
                  description: ピン留めするメッセージID
      responses:
        "201":
          description: |+
            正常にピン留めできました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Pin"

  /pin/{pinID}:
    parameters:
      - $ref: "#/components/parameters/pinIdInPath"
    get:
      tags:
        - pin
      description: ピン留めを取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Pin"
    delete:
      tags:
        - pin
      description: ピン留めを外します。
      responses:
        "204":
          description: |+
            正常に外せました。
        "404":
          description: |+
            指定したIDのピンは存在しません。

  /channels/{channelID}/notification:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    get:
      tags:
        - notification
      description: 全ユーザーの通知状況を取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            ユーザー通知状況の配列を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotificationList"
        "404":
          description: |+
            取得に失敗しました。
            指定したチャンネルは存在しません。
    put:
      tags:
        - notification
      description: |+
        チャンネルの通知状況を変更します。
        リクエストに含めなかったユーザーIDのユーザーの通知状況は変更しません。
        また、存在しないユーザーのIDを指定した場合は無視されます。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                on:
                  description: 通知をつける人のユーザーIDの配列
                  type: array
                  items:
                    type: string
                    format: uuid
                off:
                  description: 通知をつけない人のユーザーIDの配列
                  type: array
                  items:
                    type: string
                    format: uuid
      responses:
        "200":
          description: |+
            正常に更新できました。
            ユーザー通知状況の配列を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserNotificationList"
        "404":
          description: |+
            変更に失敗しました。
            指定したチャンネルは存在しません。

  /users:
    get:
      tags:
        - user
      description: 全ユーザーのリストを取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            ユーザーリストを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserList"
    post:
      tags:
        - user
      description: ユーザー登録します
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - email
                - password
              properties:
                name:
                  type: string
                  description: ユーザー名(半角英数字とアンダーバー(_)の1文字以上32文字以下)
                email:
                  type: string
                  format: email
                  description: メールアドレス
                password:
                  type: string
                  format: password
                  description: パスワード
      responses:
        "201":
          description: 正常に登録できました。
        "400":
          description: 登録できませんでした。リクエスト内容が不正です。
        "403":
          description: 登録できませんでした。権限がありません。

  /users/me:
    get:
      tags:
        - user
      description: 自分のユーザー情報を取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            自分のユーザーオブジェクトを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
    patch:
      tags:
        - user
      description: 自分のユーザー情報を変更します。displayNameのみの変更の場合以前のpasswordは不要です
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                exPassword:
                  type: string
                  description: 変更する前のパスワード
                displayName:
                  type: string
                  description: 新しい表示名(0-32文字)。変更しない場合は""
                email:
                  type: string
                  description: 変更後のメールアドレス。変更しない場合は""
                password:
                  type: string
                  description: 変更後のパスワード。変更しない場合は""
                twitterId:
                  type: string
                  description: TwitterID
      responses:
        "204":
          description: 正常に変更できました。
        "400":
          description: 正常に変更できませんでした。リクエスト内容が不正です。
        "401":
          description: 正常に変更できませんでした。パスワードが違います。

  /users/me/icon:
    get:
      tags:
        - user
      description: 自分のアイコン画像を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/gif:
              schema:
                type: string
                format: binary
            image/svg+xml:
              schema:
                type: string
                format: svg
    put:
      tags:
        - user
      description: 自分のアイコンを更新します。
      requestBody:
        content:
          multipart/form-data:
            schema:
              properties:
                file:
                  type: string
                  format: binary
                  description: 1MBまでのpng, jpeg, gif
            encoding:
              file:
                contentType: image/png, image/jpeg, image/gif
      responses:
        "200":
          description: 正常に更新できました。
        "400":
          description: 正常に更新できませんでした。不正なファイルです。

  /users/me/clips:
    get:
      tags:
        - clip
      description: 全てのクリップを取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    folderId:
                      type: string
                      format: uuid
                      description: フォルダID
                    clipId:
                      type: string
                      format: uuid
                      description: クリップID
                    clippedAt:
                      type: string
                      format: date-time
                      description: クリップ日時
                    message:
                      $ref: "#/components/schemas/Message"
    post:
      tags:
        - clip
      description: 新しくメッセージをクリップします。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - messageId
              properties:
                messageId:
                  type: string
                  format: uuid
                  description: クリップするメッセージID
                folderId:
                  type: string
                  format: uuid
                  description: クリップフォルダ名
      responses:
        "201":
          description: 正常にクリップできました。クリップIDを返します。
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                    description: クリップID
        "400":
          description: 正常にクリップできませんでした。リクエスト内容が不正です。

  /users/me/clips/{clipID}:
    parameters:
      - $ref: "#/components/parameters/clipIdInPath"
    get:
      tags:
        - clip
      description: 指定したクリップのメッセージを取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: 正常に取得できませんでした。指定したクリップは存在しません。
    delete:
      tags:
        - clip
      description: 指定したクリップを削除します。
      responses:
        "204":
          description: 正常に削除できました。
        "404":
          description: 正常に削除できませんでした。指定したクリップは存在しません。

  /users/me/clips/{clipID}/folder:
    parameters:
      - $ref: "#/components/parameters/clipIdInPath"
    get:
      tags:
        - clip
      description: 指定したクリップのフォルダ情報を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClipsFolder"
        "404":
          description: 正常に取得できませんでした。指定したクリップは存在しません。
    put:
      tags:
        - clip
      description: 指定したクリップのフォルダを変更します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - folderId
              properties:
                folderId:
                  type: string
                  format: uuid
                  description: フォルダID
      responses:
        "204":
          description: 正常に変更できました。
        "400":
          description: 正常に変更できませんでした。指定したフォルダは存在しません。
        "404":
          description: 正常に変更できませんでした。指定したクリップは存在しません。

  /users/me/clips/folders:
    get:
      tags:
        - clip
      description: クリップフォルダ一覧を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ClipsFolder"
    post:
      tags:
        - clip
      description: クリップフォルダを作成します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: フォルダ名(30文字以内)
      responses:
        "201":
          description: 正常に作成できました。作成したフォルダ情報を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClipsFolder"
        "400":
          description: 作成できませんでした。リクエスト内容が不正です。
        "409":
          description: 作成できませんでした。既に存在します。

  /users/me/clips/folders/{folderID}:
    parameters:
      - name: folderID
        description: 操作の対象となるクリップフォルダのID
        in: path
        required: true
        schema:
          type: string
          format: uuid
    get:
      tags:
        - clip
      description: フォルダ内のクリップ一覧を取得します。
      responses:
        "200":
          description: 正常に取得できました。クリップしたメッセージのリストを返します。
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    clipId:
                      type: string
                      format: uuid
                      description: クリップID
                    clippedAt:
                      type: string
                      format: date-time
                      description: クリップ日時
                    message:
                      $ref: "#/components/schemas/Message"
        "404":
          description: 取得できませんでした。存在しないフォルダです。
    patch:
      tags:
        - clip
      description: クリップフォルダ名を変更します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: フォルダ名(30文字以内)
      responses:
        "204":
          description: 正常に変更できました。
        "400":
          description: 正常に変更できませんでした。リクエスト内容が不正です。
        "404":
          description: 正常に変更できませんでした。存在しないフォルダです。
        "409":
          description: 正常に変更できませんでした。既に存在するフォルダです。
    delete:
      tags:
        - clip
      description: クリップフォルダを削除します。フォルダ内のクリップは全て削除されます。
      responses:
        "204":
          description: 正常に削除できました。
        "404":
          description: 正常に削除できませんでした。存在しないフォルダです。

  /users/me/stars:
    get:
      tags:
        - star
      description: お気に入りチャンネルリストを取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            お気に入りチャンネルリストを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelList"

  /users/me/stars/{channelID}:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    put:
      tags:
        - star
      description: お気に入りチャンネルリストにチャンネルを追加します。
      responses:
        "204":
          description: 正常に追加できました。
        "404":
          description: |+
            正常に追加できませんでした。
            対象のチャンネルが存在しません。
    delete:
      tags:
        - star
      description: |+
        お気に入りチャンネルリストから削除します。
        既にお気に入りチャンネルリストに無いチャンネルを指定した場合は無視されます(204)。
      responses:
        "204":
          description: 正常に削除されました。
        "404":
          description: |+
            削除に失敗しました。
            指定されたチャンネルは存在しません。

  /users/me/channels/visibility:
    get:
      tags:
        - visibility
      description: チャンネル一覧の可視状態を取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            可視状態を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelVisibilities"
    put:
      tags:
        - visibility
      description: |+
        チャンネルの可視状態を変更します。
        リクエストで指定しなかったチャンネルの可視状態は変更されません。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                visible:
                  type: array
                  description: 可視にするチャンネルIDの配列
                  items:
                    type: string
                    format: uuid
                hidden:
                  type: array
                  description: 非表示にするチャンネルIDの配列
                  items:
                    type: string
                    format: uuid
      responses:
        "200":
          description: |+
            正常に変更できました。
            可視状態を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelVisibilities"
        "404":
          description: |+
            正常に変更できませんでした。
            存在しないチャンネルが指定されています。

  /users/me/unread:
    get:
      tags:
        - unread
      description: 未読メッセージのリストを取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            未読メッセージリストを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageList"

  /users/me/unread/{channelID}:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    delete:
      tags:
        - unread
      description: 指定されたチャンネルの未読メッセージを既読にします。存在しないチャンネルIDを指定した場合は、無視されます。
      responses:
        "204":
          description: |+
            正常にメッセージを既読にできました。

  /users/me/stamp-history:
    get:
      tags:
        - stamp
      description: 自分のスタンプ履歴を最大50件取得します。結果は降順で返されます。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    stampId:
                      type: string
                      format: uuid
                      description: スタンプID
                    datetime:
                      type: string
                      format: date-time
                      description: そのスタンプが最後に押された日時

  /users/{userID}:
    parameters:
      - $ref: "#/components/parameters/userIdInPath"
    get:
      tags:
        - user
      description: ユーザーの詳細を取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            ユーザー情報を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDetail"
        "404":
          description: |+
            正常に取得できませんでした。
            指定したユーザーは存在しません。

  /users/{userID}/notification:
    parameters:
      - $ref: "#/components/parameters/userIdInPath"
    get:
      tags:
        - notification
      description: ユーザーが通知を入れているチャンネルのリストを取得します
      responses:
        "200":
          description: |+
            正常に取得できました。
            ユーザー通知状況の配列を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChannelList"
        "404":
          description: |+
            取得に失敗しました。
            指定したユーザーは存在しません。

  /users/{userID}/icon:
    parameters:
      - $ref: "#/components/parameters/userIdInPath"
    get:
      tags:
        - user
      description: ユーザーのアイコン画像を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/gif:
              schema:
                type: string
                format: binary
            image/svg+xml:
              schema:
                type: string
                format: svg
        "404":
          description: |+
            正常に取得できませんでした。
            指定したユーザーは存在しません。

  /users/{userID}/tags:
    parameters:
      - $ref: "#/components/parameters/userIdInPath"
    get:
      tags:
        - userTag
      description: ユーザーのタグのリストを取得します。
      responses:
        "200":
          description: |+
            正常に取得できました。
            タグのリストを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagList"
        "404":
          description: |+
            正常に取得できませんでした。
            指定したユーザーは存在しません。
    post:
      tags:
        - userTag
      description: ユーザーにタグを追加します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - tag
              properties:
                tag:
                  type: string
                  description: 追加するタグ(30文字まで)
                  example: 山田太郎
      responses:
        "201":
          description: |+
            正常に追加できました。
        "400":
          description: |+
            正常に追加できませんでした。
            パラメータの形式が不正です。
        "403":
          description: |+
            正常に追加できませんでした。
            権限がありません。
        "404":
          description: |+
            正常に追加できませんでした。
            指定したユーザーは存在しません。

  /users/{userID}/tags/{tagID}:
    parameters:
      - $ref: "#/components/parameters/userIdInPath"
      - $ref: "#/components/parameters/tagIdInPath"
    patch:
      tags:
        - userTag
      description: タグのロック、アンロックを変更します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - isLocked
              properties:
                isLocked:
                  type: boolean
                  description: lockするときはtrue,解除するときはfalse
                  example: true
      responses:
        "204":
          description: |+
            正常に変更できました。
        "400":
          description: |+
            正常に変更できませんでした。
            パラメータの形式が不正です。
        "403":
          description: |+
            正常に変更できませんでした。
            権限がありません。
        "404":
          description: |+
            正常に変更できませんでした。
            指定したユーザー、もしくはタグは存在しません。
    delete:
      tags:
        - userTag
      description: ユーザーから指定したタグを削除します。既に存在しないタグを削除しようとした場合は無視されます(204)。
      responses:
        "204":
          description: |+
            正常に削除できました。
        "403":
          description: |+
            正常に削除できませんでした。
            権限がありません。
        "404":
          description: |+
            正常に削除できませんでした。
            指定したユーザーは存在しません。

  /tags:
    get:
      tags:
        - userTag
      description: 全タグリストを取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    tagId:
                      type: string
                      format: uuid
                    tag:
                      type: string
                    users:
                      $ref: "#/components/schemas/UserList"

  /tags/{tagID}:
    parameters:
      - $ref: "#/components/parameters/tagIdInPath"
    get:
      tags:
        - userTag
      description: 指定されたタグの情報を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: object
                properties:
                  tagId:
                    type: string
                    format: uuid
                  tag:
                    type: string
                  editable:
                    type: boolean
                  type:
                    type: string
                  users:
                    $ref: "#/components/schemas/UserList"
        "404":
          description: 正常に取得できませんでした。指定されたタグIDは存在しません
    patch:
      tags:
        - userTag
      description: 指定されたタグの情報を変更します。
      requestBody:
        content:
          application/json:
            schema:
              properties:
                type:
                  type: string
                  description: タグの種類(30文字以内)
                restrict:
                  type: boolean
                  description: 操作制限付きタグにするか
                name:
                  type: string
                  description: タグ名(30文字以内)
      responses:
        "204":
          description: 正常に変更できました。
        "400":
          description: 正常に変更できませんでした。リクエストが不正です。
        "403":
          description: 正常に変更できませんでした。権限がありません。
        "404":
          description: 正常に変更できませんでした。指定されたタグは存在しません。

  /stamps:
    get:
      tags:
        - stamp
      description: 全スタンプのリストを取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Stamp"
    post:
      tags:
        - stamp
      description: スタンプを新規作成します。
      requestBody:
        content:
          multipart/form-data:
            schema:
              required:
                - name
                - file
              properties:
                name:
                  type: string
                  description: スタンプ名(半角英数字と-+_のみを含む32文字以内の文字列)
                file:
                  type: string
                  format: binary
                  description: 1MBまでのpng, jpeg, gif, svg
            encoding:
              file:
                contentType: image/png, image/jpeg, image/gif, image/svg+xml
      responses:
        "201":
          description: 正常にスタンプが作成されました。
        "400":
          description: 正常にスタンプが作成できませんでした。

  /stamps/{stampID}:
    parameters:
      - $ref: "#/components/parameters/stampIdInPath"
    get:
      description: スタンプの情報を取得します。
      tags:
        - stamp
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Stamp"
        "404":
          description: 取得できませんでした。指定されたスタンプは存在しません。
    patch:
      description: スタンプを修正します。
      tags:
        - stamp
      requestBody:
        content:
          multipart/form-data:
            schema:
              properties:
                name:
                  type: string
                  description: スタンプ名(半角英数字と-+_のみを含む32文字以内の文字列)
                file:
                  type: string
                  format: binary
                  description: 1MBまでのpng, jpeg, gif, svg
            encoding:
              file:
                contentType: image/png, image/jpeg, image/gif, image/svg+xml
      responses:
        "204":
          description: 正常に修正できました。
        "403":
          description: |+
            修正できませんでした。
            指定されたスタンプを修正する権限がありません。
        "404":
          description: |+
            修正できませんでした。
            指定されたスタンプは存在しません。
    delete:
      description: スタンプを削除します。
      tags:
        - stamp
      responses:
        "204":
          description: |+
            正常に削除できました。
        "403":
          description: |+
            削除できませんでした。
            指定されたスタンプを削除する権限がありません。
        "404":
          description: |+
            削除できませんでした。
            指定されたスタンプは存在しません。

  /files:
    post:
      tags:
        - file
      description: ファイルをアップロードします
      requestBody:
        content:
          multipart/form-data:
            schema:
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "201":
          description: |+
            正常にファイルが追加されました
            メタデータを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FileInfo"

  /files/{fileID}:
    parameters:
      - $ref: "#/components/parameters/fileIdInPath"
    get:
      tags:
        - file
      description: 指定したファイルの中身を取得します。
      parameters:
        - name: dl
          description: ファイルをダウンロードする場合に1を指定する
          in: query
          required: false
          schema:
            type: integer
      responses:
        "200":
          description: |+
            正常に取得できました。
            fileのbinaryを返します。
            application/octet-streamで返すことになっていますが、ファイルの形式によっては変わります。
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        "404":
          description: |+
            取得できませんでした。
            指定されたスタンプは存在しません。
    delete:
      tags:
        - file
      description: 指定したメッセージを削除します。
      responses:
        "200":
          description: |+
            正常に削除できました。
        "403":
          description: |+
            削除できませんでした。
            指定されたファイルを削除する権限がありません。
        "404":
          description: |+
            削除できませんでした。
            指定されたファイルは存在しないか、自分のスコープ内にありません。

  /files/{fileID}/meta:
    parameters:
      - $ref: "#/components/parameters/fileIdInPath"
    get:
      tags:
        - file
      description: 指定したファイルのメタデータを取得します
      responses:
        "200":
          description: |+
            正常に取得できました。
            メタデータを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FileInfo"
        "404":
          description: |+
            取得できませんでした。
            指定されたファイルは存在しません。

  /files/{fileID}/thumbnail:
    parameters:
      - $ref: "#/components/parameters/fileIdInPath"
    get:
      tags:
        - file
      description: 指定したファイルのサムネイルを取得します
      responses:
        "200":
          description: |+
            正常に取得できました。
            サムネイルを返します。
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
        "404":
          description: 取得できませんでした。サムネイルは存在しません。

  /messages/{messageID}:
    parameters:
      - $ref: "#/components/parameters/messageIdInPath"
    put:
      tags:
        - message
      description: 指定したメッセージを編集します。
      operationId: editMessageById
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  description: Markdown形式のメッセージ本文
                  example: Raskって誰？
      responses:
        "200":
          description: |+
            正常に編集できました。
            編集後のメッセージオブジェクトを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "403":
          description: |+
            編集できませんでした。
            指定されたメッセージを編集する権限がありません。
        "404":
          description: |+
            編集できませんでした。
            指定されたメッセージは存在しないか、自分のスコープ内にありません。
    get:
      tags:
        - message
      description: 指定したメッセージを取得します。
      operationId: getMessageById
      responses:
        "200":
          description: |+
            正常に取得できました。
            メッセージオブジェクトを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "404":
          description: |+
            取得できませんでした。
            指定されたメッセージは存在しないか、自分のスコープ内にありません。
    delete:
      tags:
        - message
      description: 指定したメッセージを削除します。
      responses:
        "204":
          description: |+
            正常に削除できました。
        "403":
          description: |+
            削除できませんでした。
            指定されたメッセージを削除する権限がありません。
        "404":
          description: |+
            削除できませんでした。
            指定されたメッセージは存在しないか、自分のスコープ内にありません。

  /messages/{messageID}/report:
    parameters:
      - $ref: "#/components/parameters/messageIdInPath"
    post:
      tags:
        - message
      description: 指定したメッセージを通報します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - reason
              properties:
                reason:
                  type: string
                  description: 通報理由(100文字以内)
      responses:
        "204":
          description: 通報を受理しました。
        "400":
          description: 通報を受理できませんでした。リクエスト内容が不正です。

  /messages/{messageID}/stamps:
    parameters:
      - $ref: "#/components/parameters/messageIdInPath"
    get:
      tags:
        - stamp
      description: 指定したメッセージに押されているスタンプを全て取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/MessageStamp"
        "404":
          description: 取得できませんでした。指定したメッセージは存在しないか、自分のスコープ内にありません。

  /messages/{messageID}/stamps/{stampID}:
    parameters:
      - $ref: "#/components/parameters/messageIdInPath"
      - $ref: "#/components/parameters/stampIdInPath"
    post:
      tags:
        - stamp
      description: 指定したメッセージに指定したスタンプを押します。
      responses:
        "204":
          description: |+
            正常にスタンプを押すことができました。
        "400":
          description: |+
            スタンプを押すことができませんでした。
            指定されたスタンプは存在しません。
        "404":
          description: |+
            スタンプを押すことができませんでした。
            指定されたメッセージは存在しないか、自分のスコープ内にありません。
    delete:
      tags:
        - stamp
      description: 指定したメッセージから指定したスタンプを外します。
      responses:
        "204":
          description: |+
            正常にスタンプを外すことができました。
        "400":
          description: |+
            スタンプを外すことができませんでした。
            指定されたスタンプは存在しません。
        "404":
          description: |+
            スタンプを外すことができませんでした。
            指定されたメッセージは存在しないか、自分のスコープ内にありません。

  /messages/search:
    get:
      tags:
        - search
      description: クエリによってメッセージを検索し、その結果を取得します。
      parameters:
        - name: query
          description: 検索のクエリ文字列
          in: query
          required: true
          schema:
            type: string
      responses:
        "200":
          description: |+
            正常に検索できました。
            検索結果に含まれたメッセージを返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageList"
        "400":
          description: |+
            正常に検索できませんでした。
            クエリが不正です。

  /heartbeat:
    get:
      tags:
        - heartbeat
      description: チャンネルを現在見ている人・編集している人を取得します。
      parameters:
        - name: channelId
          in: query
          description: 現在いるチャンネルId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: |+
            正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HeartbeatRes"
    post:
      tags:
        - heartbeat
      description: どのチャンネルを見ているか・編集しているかを送信します。
      parameters:
      - name: status
        in: query
        description: editing,monitoring,noneでユーザーの状態を指定する
        required: true
        schema:
          type: string
          enum:
            - none
            - monitoring
            - editing
      - name: channelId
        in: query
        description: 現在いるチャンネルId
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: 正常に送信できました。

  /notification:
    get:
      tags:
        - notification
      description: 通知ストリーム(Server Sent Events)に接続します。
      responses:
        "200":
          description: 接続が完了しました。

  /notification/device:
    post:
      tags:
        - notification
      description: FCMデバイスを登録します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  description: FCMのデバイストークン
                  example: bk3RNwTe3H0:CI2k_HHwgIpoDKCIZvvDMExUdFQ3P1
      responses:
        "201":
          description: 正常に登録できました。

  /webhooks:
    get:
      tags:
        - webhook
      description: 自分が作成したwebhookの一覧を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Webhook"
    post:
      tags:
        - webhook
      description: webhookを作成します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - description
                - channelId
              properties:
                name:
                  type: string
                  description: webhookユーザーの表示名(32文字まで)
                description:
                  type: string
                  description: webhookの説明
                channelId:
                  type: string
                  format: uuid
                  description: デフォルトの投稿先チャンネル
      responses:
        "201":
          description: 正常に作成できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Webhook"
        "400":
          description: 作成できませんでした。リクエスト内容が不正です。
        "403":
          description: 作成できませんでした。権限がありません。
        "404":
          description: 作成できませんでした。指定したチャンネルは存在しません。

  /webhooks/{webhookID}:
    parameters:
      - $ref: "#/components/parameters/webhookIdInPath"
    get:
      tags:
        - webhook
      description: webhookの詳細を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Webhook"
        "403":
          description: 取得できませんでした。権限がありません。
        "404":
          description: 取得できませんでした。指定したwebhookは存在しません。
    patch:
      tags:
        - webhook
      description: webhookを修正します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: webhookユーザーの表示名(32文字まで)
                description:
                  type: string
                  description: webhookの説明
                channelId:
                  type: string
                  format: uuid
                  description: デフォルトの投稿先チャンネル
      responses:
        "204":
          description: 正常に修正できました。
        "400":
          description: 修正できませんでした。リクエスト内容が不正です。
        "403":
          description: 削除できませんでした。権限がありません。
        "404":
          description: 修正できませんでした。指定したwebhookは存在しません。
    delete:
      tags:
        - webhook
      description: webhookを削除します。
      responses:
        "204":
          description: 正常に削除できました。
        "403":
          description: 削除できませんでした。権限がありません。
        "404":
          description: 削除できませんでした。指定したwebhookは存在しません。
    post:
      tags:
        - webhook
      description: webhookを送信します。
      requestBody:
        content:
          text/plain:
            schema:
              type: string
              description: メッセージ文字列
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  description: メッセージ文字列
                channelId:
                  type: string
                  format: uuid
                  description: 投稿先チャンネルID(無い場合は事前登録のデフォルト値が使われます)
          application/x-www-form-urlencoded:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  description: メッセージ文字列
                channelId:
                  type: string
                  format: uuid
                  description: 投稿先チャンネルID(無い場合は事前登録のデフォルト値が使われます)
      responses:
        "204":
          description: 正常に送信できました。
        "400":
          description: 正常に送信できませんでした。リクエスト内容が不正です。
        "404":
          description: 正常に送信できませんでした。指定されたwebhookは存在しません。

  /webhooks/{webhookID}/icon:
    parameters:
      - $ref: "#/components/parameters/webhookIdInPath"
    put:
      tags:
        - webhook
      description: 指定したwebhookのアイコンを変更します。
      requestBody:
        content:
          multipart/form-data:
            schema:
              properties:
                file:
                  type: string
                  format: binary
                  description: webhookユーザーのアイコン(1MBまでのpng, jpeg, gif)
            encoding:
              file:
                contentType: image/png, image/jpeg, image/gif
      responses:
        "204":
          description: 正常に変更できました。
        "400":
          description: 変更できませんでした。リクエスト内容が不正です。
        "403":
          description: 変更できませんでした。権限がありません。
        "404":
          description: 修正できませんでした。指定したwebhookは存在しません。

  /webhooks/{webhookID}/github:
    parameters:
      - $ref: "#/components/parameters/webhookIdInPath"
    post:
      tags:
        - webhook
      description: Github-Compatibleなwebhookを送信します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "204":
          description: 正常に送信できました。
        "400":
          description: 正常に送信できませんでした。リクエスト内容が不正です。
        "404":
          description: 正常に送信できませんでした。指定されたwebhookは存在しません。

  /bots:
    get:
      tags:
        - bot
      description: 自分が作成したBotの一覧を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Bot"
    post:
      tags:
        - bot
      description: Botを作成します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - displayName
                - description
                - postUrl
                - subscribeEvents
              properties:
                name:
                  type: string
                  description: botユーザーID(16文字まで)。自動的に先頭に"BOT_"が付与されます
                displayName:
                  type: string
                  description: botユーザーの表示名(32文字まで)
                description:
                  type: string
                  description: botの説明
                postUrl:
                  type: string
                  format: url
                  description: botのPOSTエンドポイント
                subscribeEvents:
                  type: array
                  description: botの購読イベント一覧(後から変更できません)
                  items:
                    type: string
      responses:
        "201":
          description: 正常に作成できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Bot"
        "400":
          description: 作成できませんでした。リクエスト内容が不正です。
        "403":
          description: 作成できませんでした。権限がありません。

  /bots/{botID}:
    parameters:
      - $ref: "#/components/parameters/botIdInPath"
    get:
      tags:
        - bot
      description: Botの詳細を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Bot"
        "404":
          description: 取得できませんでした。指定したBotは存在しません。
    patch:
      tags:
        - bot
      description: Botを修正します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                displayName:
                  type: string
                  description: botユーザーの表示名(32文字まで)
                description:
                  type: string
                  description: botの説明
                postUrl:
                  type: string
                  format: url
                  description: botのPOSTエンドポイント
      responses:
        "204":
          description: 正常に修正できました。
        "400":
          description: 修正できませんでした。リクエスト内容が不正です。
        "403":
          description: 削除できませんでした。権限がありません。
        "404":
          description: 修正できませんでした。指定したBotは存在しません。
    delete:
      tags:
        - bot
      description: Botを削除します。
      responses:
        "204":
          description: 正常に削除できました。
        "403":
          description: 削除できませんでした。権限がありません。
        "404":
          description: 削除できませんでした。指定したBotは存在しません。

  /bots/{botID}/icon:
    parameters:
      - $ref: "#/components/parameters/botIdInPath"
    put:
      tags:
        - bot
      description: 指定したBotのアイコンを変更します。
      requestBody:
        content:
          multipart/form-data:
            schema:
              properties:
                file:
                  type: string
                  format: binary
                  description: Botユーザーのアイコン(1MBまでのpng, jpeg, gif)
            encoding:
              file:
                contentType: image/png, image/jpeg, image/gif
      responses:
        "204":
          description: 正常に変更できました。
        "400":
          description: 変更できませんでした。リクエスト内容が不正です。
        "403":
          description: 変更できませんでした。権限がありません。
        "404":
          description: 修正できませんでした。指定したBotは存在しません。

  /bots/{botID}/activation:
    parameters:
      - $ref: "#/components/parameters/botIdInPath"
    post:
      tags:
        - bot
      description: Botをアクティベーションします。
      responses:
        "204":
          description: アクティベートされました。
        "400":
          description: アクティベートされませんでした。
        "403":
          description: アクティベートされませんでした。権限がありません。
        "404":
          description: アクティベートされませんでした。指定したBotは存在しません。

  /bots/{botID}/token:
    parameters:
      - $ref: "#/components/parameters/botIdInPath"
    get:
      tags:
        - bot
      description: Botのトークンを取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: object
                properties:
                  verificationToken:
                    type: string
                    description: 確認トークン
                  accessToken:
                    type: string
                    description: アクセストークン
        "403":
          description: 取得できませんでした。権限がありません。
        "404":
          description: 取得できませんでした。指定したBotは存在しません。
    post:
      tags:
        - bot
      description: Botのトークンを再発行します。
      responses:
        "200":
          description: 正常に再発行できました。
          content:
            application/json:
              schema:
                type: object
                properties:
                  verificationToken:
                    type: string
                    description: 確認トークン
                  accessToken:
                    type: string
                    description: アクセストークン
        "403":
          description: 再発行できませんでした。権限がありません。
        "404":
          description: 再発行できませんでした。指定したBotは存在しません。

  /bots/{botID}/code:
    parameters:
      - $ref: "#/components/parameters/botIdInPath"
    get:
      tags:
        - bot
      description: Botのインストールコードを取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: object
                properties:
                  installCode:
                    type: string
                    description: インストールコード
        "403":
          description: 取得できませんでした。権限がありません。
        "404":
          description: 取得できませんでした。指定したBotは存在しません。

  /channels/{channelID}/bots:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
    get:
      tags:
        - bot
      description: チャンネルにインストールされているBot一覧を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    botId:
                      type: string
                      format: uuid
                      description: BotのID
                    installedBy:
                      type: string
                      format: uuid
                      description: Botをインストールしたユーザー
                    installedAt:
                      type: string
                      format: date-time
                      description: Botがインストールされた日時
        "404":
          description: 取得できませんでした。指定したチャンネルは存在しません。
    post:
      tags:
        - bot
      description: チャンネルにBotをインストールします。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              properties:
                code:
                  type: string
                  description: インストールコード
      responses:
        "200":
          description: 正常にインストールできました。
          content:
            application/json:
              schema:
                type: object
                properties:
                  botId:
                    type: string
                    format: uuid
                    description: インストールされたBotのID
        "400":
          description: インストールできませんでした。リクエスト内容が不正です。
        "404":
          description: インストールできませんでした。指定したチャンネルは存在しません。

  /channels/{channelID}/bots/{botID}:
    parameters:
      - $ref: "#/components/parameters/channelIdInPath"
      - $ref: "#/components/parameters/botIdInPath"
    delete:
      tags:
        - bot
      description: Botをチャンネルからアンインストールします。
      responses:
        "204":
          description: 正常にアンインストールできました。
        "404":
          description: アンインストールできませんでした。指定したチャンネル、またはBotは存在しません。

  /users/me/tokens:
    get:
      tags:
        - client
      description: 自分が許可しているクライアントの一覧とトークン情報を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AllowedClientInfo"
        "403":
          description: 取得できませんでした。権限がありません。

  /users/me/tokens/{oauth2TokenID}:
    parameters:
      - $ref: "#/components/parameters/oauth2TokenIdInPath"
    delete:
      tags:
        - client
      description: 指定したトークンの認可を取り消します。
      responses:
        "204":
          description: 正常に取り消すことができました。
        "403":
          description: 失敗しました。権限がありません。
        "404":
          description: 失敗しました。指定したトークンは存在しません。

  /clients:
    get:
      tags:
        - client
      description: 自分が登録しているクライアントの一覧を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OwnedClientInfo"
        "403":
          description: 取得できませんでした。権限がありません。
    post:
      tags:
        - client
      description: クライアントを登録します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - description
                - redirectUri
                - scopes
              properties:
                name:
                  type: string
                  description: クライアント名(1-32文字)
                description:
                  type: string
                  description: クライアントの説明
                redirectUri:
                  type: string
                  format: uri
                  description: リダイレクト先のURI
                scopes:
                  type: array
                  description: 要求するスコープ(必ず１つ以上)
                  items:
                    type: string
      responses:
        "200":
          description: 正常に登録できました。クライアント情報を返します。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OwnedClientInfo"
        "400":
          description: 登録できませんでした。リクエスト内容が不正です。
        "403":
          description: 登録できませんでした。権限がありません。

  /clients/{clientID}:
    parameters:
      - $ref: "#/components/parameters/clientIdInPath"
    get:
      tags:
        - client
      description: 指定したクライアントIDのクライアントの情報を取得します。
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientInfo"
        "404":
          description: 取得できませんでした。指定されたクライアントは存在しません。
    patch:
      tags:
        - client
      description: 指定したクライアントIDのクライアントの情報を変更します。
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: クライアント名(1-32文字)
                description:
                  type: string
                  description: 説明
                redirectUri:
                  type: string
                  format: uri
                  description: リダイレクト先のURI
      responses:
        "204":
          description: 正常に変更できました。
        "403":
          description: 変更できませんでした。権限がありません。
        "404":
          description: 変更できませんでした。指定されたクライアントは存在しません。
    delete:
      tags:
        - client
      description: |+
        指定したクライアントIDのクライアントを削除します。
        正常に削除された場合、このクライアントを通じての認可は全て取り消されます。
      responses:
        "204":
          description: 正常に削除できました。
        "403":
          description: 削除できませんでした。権限がありません。
        "404":
          description: 削除できませんでした。指定されたクライアントは存在しません。

  /reports:
    get:
      tags:
        - message
      description: メッセージ通報を最大50件取得します。
      parameters:
        - name: p
          in: query
          description: ページ番号(ゼロオリジン)
          schema:
            type: integer
      responses:
        "200":
          description: 正常に取得できました。
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      format: uuid
                      description: 通報ID
                    messageId:
                      type: string
                      format: uuid
                      description: 通報対象のメッセージID
                    reporter:
                      type: string
                      format: uuid
                      description: 通報者ID
                    reason:
                      type: string
                      description: 通報内容
                    createdAt:
                      type: string
                      format: date-time
                      description: 通報日時
        "403":
          description: 取得できませんでした。権限がありません。

components:
  parameters:
    channelIdInPath:
      name: channelID
      description: 操作の対象となるチャンネルのID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    userIdInPath:
      name: userID
      description: 操作の対象となるユーザーID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    messageIdInPath:
      name: messageID
      in: path
      required: true
      description: 操作の対象となるメッセージID
      schema:
        type: string
        format: uuid
    stampIdInPath:
      name: stampID
      description: 操作の対象となるスタンプID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    tagIdInPath:
      name: tagID
      description: 操作の対象となるタグID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    fileIdInPath:
      name: fileID
      description: 操作の対象となるファイルID
      in: path
      required: true
      schema:
        type: string
    pinIdInPath:
      name: pinID
      description: 操作の対象となるピン留めID
      in: path
      required: true
      schema:
        type: string
    clipIdInPath:
      name: clipID
      description: 捜査の対象となるクリップのID
      in: path
      required: true
      schema:
        type: string
    webhookIdInPath:
      name: webhookID
      description: 操作の対象となるWebhookのID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    botIdInPath:
      name: botID
      description: 操作の対象となるBotのID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    clientIdInPath:
      name: clientID
      description: 操作の対象となるclientのID
      in: path
      required: true
      schema:
        type: string
        format: uuid
    oauth2TokenIdInPath:
      name: oauth2TokenID
      description: 操作の対象となるTokenのID
      in: path
      required: true
      schema:
        type: string
        format: uuid

  schemas:
    Channel:
      type: object
      properties:
        channelId:
          type: string
          format: uuid
        name:
          type: string
        member:
          type: array
          format: uuid
          description: privateチャンネルの場合は参加しているメンバー、公開チャンネルの場合は空
        parent:
          type: string
          format: uuid
          description: 親の階層のチャンネルId
        children:
          type: array
          description: 子のチャンネルIdの配列
        visibility:
          type: boolean
          description: チャンネルの可視状態
        force:
          type: boolean
          description: 強制通知チャンネルか

    ChannelTopic:
      type: object
      properties:
        channelId:
          type: string
          format: uuid
        name:
          type: string
        text:
          type: string

    ChannelList:
      type: array
      items:
        $ref: "#/components/schemas/Channel"

    ChannelVisibilities:
      type: object
      properties:
        visible:
          type: array
          description: 可視状態のチャンネルIDの配列
          items:
            type: string
            format: uuid
          example:
            - xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
            - xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
        hidden:
          type: array
          description: 非表示状態のチャンネルIDの配列
          items:
            type: string
            format: uuid
          example:
            - xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
            - xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx

    User:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        name:
          type: string
        displayName:
          type: string
        iconFileId:
          type: string
          format: uuid
        bot:
          type: boolean
        lastOnline:
          type: string
          format: date-time
          description: 最終オンライン日時(オンラインに１度もなってない場合はnull)
        isOnline:
          type: boolean
          description: 現在オンラインかどうか

    UserDetail:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        name:
          type: string
        displayName:
          type: string
        iconFileId:
          type: string
          format: uuid
        bot:
          type: boolean
        twitterId:
          type: string
        lastOnline:
          type: string
          format: date-time
          description: 最終オンライン日時(オンラインに１度もなってない場合はnull)
        isOnline:
          type: boolean
          description: 現在オンラインかどうか
        tagList:
          $ref: "#/components/schemas/TagList"

    Tag:
      type: object
      properties:
        tagId:
          type: string
          format: uuid
        tag:
          type: string
        isLocked:
          type: boolean
        editable:
          type: boolean
        type:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    TagList:
      type: array
      items:
        $ref: "#/components/schemas/Tag"

    UserList:
      type: array
      items:
        $ref: "#/components/schemas/User"

    Message:
      type: object
      properties:
        messageId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        parentChannelId:
          type: string
        pin:
          type: boolean
        reported:
          type: boolean
        content:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        stampList:
          type: array
          items:
            $ref: "#/components/schemas/MessageStamp"

    MessageList:
      type: array
      items:
        $ref: "#/components/schemas/Message"

    MessageStamp:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        stampId:
          type: string
          format: uuid
        count:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Stamp:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        creatorId:
          type: string
          format: uuid
        fileId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    FileInfo:
      type: object
      properties:
        fileId:
          type: string
          format: uuid
        name:
          type: string
        mime:
          type: string
        size:
          type: integer
        dateTime:
          type: string
          format: date-time
        hasThumb:
          type: boolean
        thumbWidth:
          type: integer
        thumbHeight:
          type: integer

    Pin:
      type: object
      properties:
        pinId:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        dateTime:
          type: string
          format: date-time
        message:
          $ref: "#/components/schemas/Message"

    PinList:
      type: array
      items:
        $ref: "#/components/schemas/Pin"

    UserNotification:
      type: object
      properties:
         userId:
          type: string
          format: uuid
         name:
          type: string
         notification:
          type: boolean

    UserNotificationList:
      type: array
      items:
        $ref: "#/components/schemas/UserNotification"

    UserHeartbeatStatus:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - monitoring
            - editing
      example:
        userId: xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
        status: monitoring

    HeartbeatRes:
      type: object
      properties:
        userStatuses:
          type: array
          items:
            $ref: "#/components/schemas/UserHeartbeatStatus"
        channelId:
          type: string
          format: uuid
      example:
        userStatuses:
          - userId: xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
            status: monitoring
          - userId: xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx
            status: editing
        channelId: xxxxxxxx-xxxx-xxxx-Nxxx-xxxxxxxxxxxx

    Webhook:
      type: object
      properties:
        webhookId:
          type: string
          format: uuid
        botUserId:
          type: string
          format: uuid
        displayName:
          type: string
        description:
          type: string
        channelId:
          type: string
          format: uuid
        creatorId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ClientInfo:
      type: object
      properties:
        clientId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        creatorId:
          type: string
          format: uuid

    OwnedClientInfo:
      type: object
      properties:
        clientId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        creatorId:
          type: string
          format: uuid
        scopes:
          type: array
          items:
            type: string
        redirectUri:
          type: string
          format: uri
        secret:
          type: string

    AllowedClientInfo:
      type: object
      properties:
        tokenId:
          type: string
          format: uuid
        clientId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        creatorId:
          type: string
          format: uuid
        scopes:
          type: array
          items:
            type: string
        approvedAt:
          type: string
          format: date-time

    ClipsFolder:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: フォルダID
        name:
          type: string
          description: フォルダ名

    Bot:
      type: object
      properties:
        botId:
          type: string
          format: uuid
        botUserId:
          type: string
          format: uuid
        name:
          type: string
        displayName:
          type: string
        description:
          type: string
        subscribeEvents:
          type: array
          items:
            type: string
        activated:
          type: boolean
        creatorId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
